# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# Geocode1Check.py
# Created on: 2017-11-02 15:24:26.00000
#   (generated by ArcGIS/ModelBuilder)
# Description: 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy


# Local variables:
Cincinnati_OH_1930_Geocode = "Cincinnati_OH_1930_Geocode"
Cincinnati_OH_1930_Geocode__2_ = Cincinnati_OH_1930_Geocode
Cincinnati_OH_1930_EdChi = "Cincinnati_OH_1930_EdChi"
Geocode1spatjoin2_shp = "C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Geocode1spatjoin2.shp"
Geocode1spatjoin2_shp__2_ = Geocode1spatjoin2_shp
formattedEDs_dbf = "C:\\Users\\dschleit\\Desktop\\GeocodeModel\\formattedEDs.dbf"
Geocode1spatjoin2_shp__3_ = Geocode1spatjoin2_shp__2_
Geocode1spatjoin2_shp__5_ = Geocode1spatjoin2_shp__3_
Cincinnati_OH_1930Geocode1Correct_shp = "C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930Geocode1Correct.shp"
Cincinnati_OH_1930Geocode1Correct_shp__3_ = Cincinnati_OH_1930Geocode1Correct_shp
Cincinnati_OH_1930Geocode1Correct_shp__4_ = Cincinnati_OH_1930Geocode1Correct_shp__3_
Cincinnati_OH_1930_Geocode1NotCorrect_shp = "C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp"
Cincinnati_OH_1930_Geocode1NotCorrect_shp__2_ = Cincinnati_OH_1930_Geocode1NotCorrect_shp
ToGeocode2_dbf = Cincinnati_OH_1930_Geocode1NotCorrect_shp__2_
GeocodeModel = "C:\\Users\\dschleit\\Desktop\\GeocodeModel"

# Process: Delete Field (4)
arcpy.DeleteField_management(Cincinnati_OH_1930_Geocode, "ed_1;contig_ed;ed_12;contig_e_1;is_touch;ed_12_13;contig_e_2")

# Process: Spatial Join
arcpy.SpatialJoin_analysis(Cincinnati_OH_1930_Geocode__2_, Cincinnati_OH_1930_EdChi, Geocode1spatjoin2_shp, "JOIN_ONE_TO_ONE", "KEEP_ALL", "Status \"Status\" true true false 1 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,Status,-1,-1;Score \"Score\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,Score,-1,-1;Match_type \"Match_type\" true true false 2 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,Match_type,-1,-1;Match_addr \"Match_addr\" true true false 120 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,Match_addr,-1,-1;Side \"Side\" true true false 1 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,Side,-1,-1;Ref_ID \"Ref_ID\" true true false 10 Long 0 10 ,First,#,Cincinnati_OH_1930_Geocode,Ref_ID,-1,-1;User_fld \"User_fld\" true true false 120 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,User_fld,-1,-1;Addr_type \"Addr_type\" true true false 20 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,Addr_type,-1,-1;ARC_Street \"ARC_Street\" true true false 100 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ARC_Street,-1,-1;ARC_City \"ARC_City\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ARC_City,-1,-1;ARC_State \"ARC_State\" true true false 20 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ARC_State,-1,-1;OBJECTID_1 \"OBJECTID_1\" true true false 10 Long 0 10 ,First,#,Cincinnati_OH_1930_Geocode,OBJECTID_1,-1,-1;ID \"ID\" true true false 10 Long 0 10 ,First,#,Cincinnati_OH_1930_Geocode,ID,-1,-1;V1 \"V1\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,V1,-1,-1;INDEX \"INDEX\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,INDEX,-1,-1;PID \"PID\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,PID,-1,-1;HHID \"HHID\" true true false 14 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,HHID,-1,-1;DN \"DN\" true true false 14 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,DN,-1,-1;INSTITUTIO \"INSTITUTIO\" true true false 59 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,INSTITUTIO,-1,-1;BLOCK \"BLOCK\" true true false 10 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,BLOCK,-1,-1;REL_ID \"REL_ID\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,REL_ID,-1,-1;IMAGE_ID \"IMAGE_ID\" true true false 15 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,IMAGE_ID,-1,-1;LINE_NUM \"LINE_NUM\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,LINE_NUM,-1,-1;ED \"ED\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ED,-1,-1;HN_RAW \"HN_RAW\" true true false 21 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,HN_RAW,-1,-1;HN \"HN\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,HN,-1,-1;HN_CHOICE \"HN_CHOICE\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_Geocode,HN_CHOICE,-1,-1;HN_FLAG \"HN_FLAG\" true true false 21 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,HN_FLAG,-1,-1;STREET_RAW \"STREET_RAW\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,STREET_RAW,-1,-1;STREET_PRE \"STREET_PRE\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,STREET_PRE,-1,-1;STREET_FUZ \"STREET_FUZ\" true true false 41 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,STREET_FUZ,-1,-1;OVERALL_MA \"OVERALL_MA\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,OVERALL_MA,-1,-1;ST_CHOICE \"ST_CHOICE\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ST_CHOICE,-1,-1;ST \"ST\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ST,-1,-1;ADDRESS \"ADDRESS\" true true false 40 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,ADDRESS,-1,-1;CITY \"CITY\" true true false 15 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,CITY,-1,-1;STATE \"STATE\" true true false 5 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,STATE,-1,-1;GEOCODE194 \"GEOCODE194\" true true false 32 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,GEOCODE194,-1,-1;GEOCODE201 \"GEOCODE201\" true true false 32 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,GEOCODE201,-1,-1;NOTGEOCODE \"NOTGEOCODE\" true true false 32 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,NOTGEOCODE,-1,-1;GEOSTATUS \"GEOSTATUS\" true true false 32 Text 0 0 ,First,#,Cincinnati_OH_1930_Geocode,GEOSTATUS,-1,-1;ed_strng \"ed_strng\" true true false 10 Long 0 10 ,First,#,Cincinnati_OH_1930_Geocode,ed_strng,-1,-1;OBJECTID \"OBJECTID\" true true false 10 Long 0 10 ,First,#,Cincinnati_OH_1930_EdChi,OBJECTID,-1,-1;ed_1 \"ed_1\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_EdChi,ed,-1,-1;Shape_Leng \"Shape_Leng\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_EdChi,Shape_Leng,-1,-1;Shape_Area \"Shape_Area\" true true false 19 Double 0 0 ,First,#,Cincinnati_OH_1930_EdChi,Shape_Area,-1,-1;ED_int \"ED_int\" true true false 5 Long 0 5 ,First,#,Cincinnati_OH_1930_EdChi,ED_int,-1,-1;Ed_str \"Ed_str\" true true false 5 Text 0 0 ,First,#,Cincinnati_OH_1930_EdChi,Ed_str,-1,-1", "INTERSECT", "25 Feet", "")

# Process: Join Field
arcpy.JoinField_management(Geocode1spatjoin2_shp, "ed_1", formattedEDs_dbf, "ed", "OID;ed;contig_ed")

# Process: Add Field
arcpy.AddField_management(Geocode1spatjoin2_shp__2_, "is_touch", "SHORT", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field
arcpy.CalculateField_management(Geocode1spatjoin2_shp__3_, "is_touch", "is_touch( !ED!, !contig_ed! )", "PYTHON_9.3", "def is_touch(ED, neighbor) :\\n    a =  str(int(ED))\\n    blist = neighbor.split(\";\")\\n    if a in blist :\\n        return 1\\n    else :\\n        return 0")

# Process: Select
arcpy.Select_analysis(Geocode1spatjoin2_shp__5_, Cincinnati_OH_1930Geocode1Correct_shp, "(\"Status\" = 'M' OR \"Status\" = 'T' ) AND \"is_touch\" =1")

# Process: Add Field (2)
arcpy.AddField_management(Cincinnati_OH_1930Geocode1Correct_shp, "Geo1930", "SHORT", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (2)
arcpy.CalculateField_management(Cincinnati_OH_1930Geocode1Correct_shp__3_, "Geo1930", "1", "", "")

# Process: Select (2)
arcpy.Select_analysis(Geocode1spatjoin2_shp__5_, Cincinnati_OH_1930_Geocode1NotCorrect_shp, "\"is_touch\" = 0 OR \"Status\" = 'U'")

# Process: Delete Field
arcpy.DeleteField_management(Cincinnati_OH_1930_Geocode1NotCorrect_shp, "Join_Count;TARGET_FID;Status;Score;Match_type;Match_addr;Side;Ref_ID;User_fld;Addr_type;ARC_Street;ARC_City;ARC_State;OBJECTID_1;GEOCODE194;GEOCODE201;NOTGEOCODE;GEOSTATUS;ed_strng;OBJECTID;ed_1;Shape_Leng;Shape_Area;ED_int;Ed_str;ed_12;contig_ed;is_touch")

# Process: Table to Table
arcpy.TableToTable_conversion(Cincinnati_OH_1930_Geocode1NotCorrect_shp__2_, GeocodeModel, "ToGeocode2.dbf", "", "ID \"ID\" true true false 10 Long 0 10 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,ID,-1,-1;V1 \"V1\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,V1,-1,-1;INDEX \"INDEX\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,INDEX,-1,-1;PID \"PID\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,PID,-1,-1;HHID \"HHID\" true true false 14 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,HHID,-1,-1;DN \"DN\" true true false 14 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,DN,-1,-1;INSTITUTIO \"INSTITUTIO\" true true false 59 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,INSTITUTIO,-1,-1;BLOCK \"BLOCK\" true true false 10 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,BLOCK,-1,-1;REL_ID \"REL_ID\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,REL_ID,-1,-1;IMAGE_ID \"IMAGE_ID\" true true false 15 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,IMAGE_ID,-1,-1;LINE_NUM \"LINE_NUM\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,LINE_NUM,-1,-1;ED \"ED\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,ED,-1,-1;HN_RAW \"HN_RAW\" true true false 21 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,HN_RAW,-1,-1;HN \"HN\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,HN,-1,-1;HN_CHOICE \"HN_CHOICE\" true true false 19 Double 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,HN_CHOICE,-1,-1;HN_FLAG \"HN_FLAG\" true true false 21 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,HN_FLAG,-1,-1;STREET_RAW \"STREET_RAW\" true true false 40 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,STREET_RAW,-1,-1;STREET_PRE \"STREET_PRE\" true true false 40 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,STREET_PRE,-1,-1;STREET_FUZ \"STREET_FUZ\" true true false 41 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,STREET_FUZ,-1,-1;OVERALL_MA \"OVERALL_MA\" true true false 40 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,OVERALL_MA,-1,-1;ST_CHOICE \"ST_CHOICE\" true true false 40 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,ST_CHOICE,-1,-1;ST \"ST\" true true false 40 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,ST,-1,-1;ADDRESS \"ADDRESS\" true true false 40 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,ADDRESS,-1,-1;CITY \"CITY\" true true false 15 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,CITY,-1,-1;STATE \"STATE\" true true false 5 Text 0 0 ,First,#,C:\\Users\\dschleit\\Desktop\\GeocodeModel\\Cincinnati_OH_1930_Geocode1NotCorrect.shp,STATE,-1,-1", "")

